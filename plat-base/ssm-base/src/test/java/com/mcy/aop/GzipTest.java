package com.mcy.aop;

import com.mingtai.base.util.GzipUtil;
import org.junit.Test;
import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Paths;

/**
 * @author zkzc-mcy create at 2018/8/8.
 */
public class GzipTest {

    @Test
    public void testGzip(){
        String json = "犹记新中国成立之初，中国国民生产总值只有区区100多亿美元，重工业几乎为零，轻工业只是少数纺织业。毛主席曾经感慨，我们除了能造桌子椅子，能造茶壶茶碗，连一辆汽车、一架飞机、一辆坦克、一辆拖拉机都不能造。正是在这一穷二白、满目疮痍的烂摊子上，我们顶住了帝国主义经济、军事的全面封锁，抗击了战火烧到鸭绿江边的严重威胁，战胜了三年自然灾害的极度困难……建立起独立的、比较完整的工业体系和国民经济体系，甩掉了“贫油国”的帽子，生产了自己的解放牌汽车、东方红拖拉机，研制出震惊世界的“两弹一星”……中国人民自力更生、艰苦奋斗，不仅在政治上、而且在经济上挺起了腰杆，国家的面貌、人们的生活发生了根本性的改变。\n" +
                "犹记改革开放之初，粮票、油票、肉票、布票、副食本、工业券等是老百姓的生活必需，甚至买糖果糕点、火柴肥皂都要票证；几代人同居一室十分普遍，土坯房、茅草房，筒子楼、大杂院是城乡居民生活的深刻印记；自行车、手表、缝纫机、收音机“三转一响”成为人们生活的奢侈品；法国戴高乐机场一小时起降60架飞机，而北京首都国际机场一小时仅能起降2架；日本东京的大型商店商品多达50万种，而北京的王府井百货大楼仅有2.2万种……\n" +
                "正是在这种物资匮乏、生活贫困、国民经济濒临崩溃边缘的情况下，我们果敢作出以经济建设为中心、实行改革开放的战略抉择，冲破思想观念的桎梏，破除体制机制的障碍，走出了一条中国特色社会主义道路。我们经历了价格闯关的艰辛，经历了西方国家制裁的艰难，经历了亚洲金融风暴、国际金融危机的冲击,经历了特大洪水、特大地震、非典疫情等的考验……在大海中练就游泳、在磨砺中愈加坚强，我国经济实力、科技实力、国防实力和综合国力实现了历史性跨越，中国人民的生活告别了“票证时代”、走过了“温饱阶段”、迎来了“全面小康”。\n" +
                "栉风沐雨，春华秋实。今天，中国以世界第二大经济体的实力，托举起覆盖13亿多人的全球最大社会保障网，创造了每年减贫1300多万人的脱贫奇迹，书写下幼有所育、学有所教、劳有所得、病有所医、老有所养、住有所居、弱有所扶的民生篇章，亿万人民携手冲刺全面小康的百年梦想……这一项项巨大成就、一串串亮丽数字的背后，挺立的是中国人民顶风冒雨的钢铁脊梁，浸透的是中国人民风雨兼程的辛勤汗水，凝结的是中国人民对美好生活的追求与梦想。\n" +
                "【二】\n" +
                "山以险峻成其巍峨，海以奔涌成其壮阔。我们已经走过了万水千山，但走向未来仍需要不断跋山涉水。美好生活不是温室里的生活，不是真空里的生活，风风雨雨就是生活的本身。\n" +
                "\n" +
                "创造美好生活，就要解决“快速发展”留下的问题。我们要改变粗放的经济发展方式，实现高质量发展，还需“奋力一跃”；要缩小城乡之间、东西部之间的发展差距，实现乡村振兴、区域协调发展，任务十分艰巨；要补上社会治理相对滞后、公共安全风险多发的短板，推进国家治理体系和治理能力现代化，仍然任重道远；要还清在生态环境上的历史欠账，建设山清水秀、天高云淡的美丽中国，唯有久久为功……凡此种种，都是我们急速行军后必须拉上的掉队一员，都是我们再踏征程必须重整的行装。\n" +
                "创造美好生活，就要破除“发展起来之后”的烦恼。当我们作别了一个个老问题，许多新问题又迎面而来，当我们翻越了层层山峦，新的高峰又耸立眼前。高速行进40年的中国社会，人口红利减弱，制度红利、技术红利亟待挖掘；社会生产能力大大提升，产能过剩、有效供给不足日益凸显……即将迈入全面小康的中国人民，不仅对物质文化生活提出了更高要求，而且在民主、法治、公平、正义、安全、环境等方面的要求日益增长，期盼有更好的教育、更稳定的工作、更满意的收入、更可靠的社会保障、更高水平的医疗卫生服务、更舒适的居住条件、更优美的环境……人民群众对美好生活的需要水涨船高。凡此种种，都是我们走到这个发展阶段之后，必须面对的挑战、必须抵达的前方。\n" +
                "创造美好生活，就要迈过“进一步发展”绕不开的坎。立足新的时代条件，打开新的发展空间，继续闯出一片新的天地，需要我们跨越横亘在前进道路上的一道道沟坎、一个个险滩。全面建成小康社会，需要打好防范化解重大风险、精准脱贫、污染防治三大攻坚战；推进全面深化改革，需要啃下利益固化藩篱的“硬骨头”；实现创新驱动发展，需要在关键核心技术上取得重大突破……还要看到，今日中国之发展，已经不是一条平静的“内流河”，而是时刻与全球经济交融激荡的“世界性洋流”。我们坚持和平发展、合作共赢，发展更高层次开放型经济、推动建设开放型世界经济，而有人不愿意看到醒狮的振奋、巨龙的腾飞，不愿意看到13亿多人的生活美好，大搞单边主义、保护主义、贸易霸凌主义，这是无法回避、必须应对的挑战。\n" +
                "风雨多经人不老，关山初度路犹长。回溯历史，让我们摆脱“开除球籍”忧思的，是中华儿女敢教日月换新天的壮志；助我们“杀出一条血路”的，是亿万人民那一股子敢闯敢干的气呀、劲呀。中国人一以贯之的“行动哲学”，便是经历风雨才能见到彩虹，闯过隘口才能一马平川。\n" +
                "【三】\n" +
                "把握历史进程，认识历史事件，需要把视线拉长，把过往与当下、现实与未来贯通起来审视，这就是历史学界常讲的“大历史观”。用这样的眼光，看待中国人民在创造美好生活、实现复兴梦想进程中正在经历和可能遇到的种种风雨，就能始终在喧嚣中保持一份清醒，在激荡中保持一份从容。\n" +
                "\n" +
                "我们自信，“我国正处于一个大有可为的历史机遇期”。在民族复兴爬坡过坎的关键阶段，在当今世界风云际会的变局之中，以习近平同志为核心的党中央举旗定向、掌舵领航，励精图治、革故鼎新，攻坚克难、力除积弊，解决了许多长期想解决而没有解决的难题，办成了许多过去想办而没有办成的大事，党在革命性锻造中更加坚强，党和国家事业发展取得历史性成就、发生历史性变革，开创了中国特色社会主义新时代。在这个新时代，经济质量效益持续提升，民生普惠得到更好保障，党的凝聚力创造力战斗力大大增强，亿万人民追梦圆梦意气风发、正当其时……前不久，中国经济亮出喜人“半年报”，GDP增长6.8%，连续12个季度稳定运行在中高速区间，全国居民人均可支配收入实际增长6.6%，城镇调查失业率连续3个月低于5%，万元GDP能耗同比下降3.2%……中国依然是世界上发展最好、潜力最大、韧性最足的国家之一。难得的历史机遇，积极向好的基本面，正是我们自信的底气所在。\n" +
                "我们坚定，“中国特色社会主义制度是当代中国发展进步的根本制度保障”。制度是管根本、管长远的。中国共产党带领中国人民经过长期艰辛探索，特别是改革开放40年的不懈奋斗，在开辟的中国特色社会主义道路上，完善和发展了中国特色社会主义制度。这个制度，保障了党的领导、人民当家作主、依法治国的有机统一，实现了激发活力与集聚力量的有效结合，极大地解放和发展了社会生产力，充分调动了亿万劳动者的积极性、主动性、创造性，有效实现、维护、发展了人民的根本利益和现实利益。正是在这个制度下，精准扶贫脱贫取得决定性进展，蓝天保卫战、碧水保卫战、净土保卫战成效斐然，维护民生安全、公共安全的举措坚强有力……中国制度的优势充分释放，我们持续健康发展、战胜风雨考验的意志如铁、信念如钢。\n" +
                "我们从容，“让世界经济的大海退回到一个一个孤立的小湖泊、小河流，是不可能的，也是不符合历史潮流的”。世界多极化、经济全球化、社会信息化、文化多样化深入发展，人类社会越来越成为你中有我、我中有你的地球村，构建休戚与共的命运共同体、合作共赢的利益共同体，人心所向、大势所趋。一些人为一己之私逆潮流而动、悖道义而行，关税的壁垒肆意高起，霸权的大棒到处挥舞，虽可逞一时得意之洋洋，但难以解决经济失衡、政治失序等深层矛盾，最终只会搬起石头砸自己的脚，成为历史潮流不可阻挡的一个注脚。打开窗子让空气对流，打开大门行天地广阔。我们以和平、合作、互利、共赢作为基本价值取向，站立的是时代的潮头、道义的高地，追求的是给全世界各国人民带来更多福祉、创造更多红利。行大道以利天下，我们就能够乱云飞渡仍从容，迈着坚实的步伐，在历史前进的逻辑中前进、在时代发展的潮流中发展。\n" +
                "“大雪压青松，青松挺且直”“千磨万击还坚劲，任尔东西南北风”“墙角数枝梅，凌寒独自开”……中国人赞赏松竹梅为“岁寒三友”，正是因为它们面对风霜雨雪而无惧、历经数九寒冬而不凋。这种蕴含于内的顽强力量、外化于形的坚韧气质，千百年来始终激励着中华民族不畏风雨、不屈不挠、砥砺前行。";

        try {
            System.out.println("压缩前体积：" + json.getBytes().length);
            byte[] compress = GzipUtil.compress(json, "utf-8");
            System.out.println("压缩后体积：" + compress.length);

            byte[] uncompress = GzipUtil.uncompress(new ByteArrayInputStream(compress));
            System.out.println("解压后体积：" + uncompress.length);

            String str = new String(uncompress, "utf-8");
            System.out.println("解压后内容：" + str);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    @Test
    public void test(){
        try {
            byte[] xiyouji = Files.readAllBytes(Paths.get("C:\\Users\\zkzc-mcy\\Desktop\\西游记.txt"));

            System.out.println("压缩前体积：" + xiyouji.length/1024 + "k");

            byte[] compress = GzipUtil.compress(xiyouji);
            System.out.println("压缩后体积：" + compress.length/1024 + "k");

            byte[] uncompress = GzipUtil.uncompress(new ByteArrayInputStream(compress));
            System.out.println("解压后体积：" + uncompress.length/1024 + "k");

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
